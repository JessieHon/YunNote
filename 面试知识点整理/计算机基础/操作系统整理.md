# 操作系统整理

## 信号量

## 进程与进程管理

### 背景

- 操作系统所具有的四大特点都是基于进程而形成的（并发，共享，虚拟，异步）
- 为了使程序在多道程序环境下能够并发执行，并对并发执行的程序加以控制和描述，引入了进程的观念

### 进程

- 组成
  - 程序段
  - 数据段
  - 进程控制块：存放了进程标识符，进程运行当前的状态，程序和数据的地址以及保存该程序运行时处理机的环境信息
- 概念：进程是具有独立功能的可并发执行的程序在一个数据集合上的运行的过程
- 属性：
  - 进程是系统进行资源分配和调度的独立单位
- 基本状态
  - 就绪：进程已经分配到除了处理机之外的所有必要的资源之后，只要再获得处理机就可以执行。
  - 执行：进程已经获得处理机，其程序正在执行。
  - 阻塞：进程因为某些事件（I/O请求，申请缓存空间等）而暂停执行的状态，亦即进程的执行收到阻塞，称为阻塞状态、等待状态、睡眠状态
    - 通常将处于阻塞状态的进程排成一个队列，称为阻塞队列。

### 进程控制

- 进程控制的主要任务是创建和撤销进程以及实现进程的状态转换
- 进程控制一般由操作系统的内核来实现
- 进程之间的关系：进程树
  - 子进程可以继承父进程所拥有的资源，当子进程撤销时，应将从父进程那里获得的资源归还给父进程
  - 撤销父进程时，也必须同时撤销其所有的子进程。

### 线程

- 背景
  - 在操作系统中引入进程的目的是使多个程序并发执行以改善资源利用率及提高系统的吞吐量，那么在操作系统中引入线程，则是为了减少程序并发执行时付出的时空开销，使操作系统具有更好的并发性。
- 属性
  - 线程是可以独立调度和分派的基本单位
  - 线程自己基本上不拥有系统资源，只拥有一点在运行中必不可少的资源（如程序计数器，一组寄存器和栈）
  - 与同属一个进程的其他线程共享进程所拥有的全部资源
  - 一个线程可以创建和撤销另一个线程，同一个进程中的多个线程之间可以并发执行
- 状态
  - 就绪
  - 阻塞
  - 执行

### 线程进程对比

- 对比
  - 调度
  - 拥有资源
  - 并发性：使操作系统拥有更好的并发性，更有效的使用系统资源和提高系统吞吐量
  - 系统开销
  - 同一个进程的多个线程资源共享，不同进程资源隔离
  - 进程和线程的地址空间关系
    - 每个线程都有自己的堆栈空间，但是线程堆栈的地址是按照进程地址空间统一编址的，所以每个线程堆栈地址空间是不会重复的，即：每个线程堆栈的地址空间不是从0开始编址，而是按整个进程地址空间统一编址的。
- 线程分类
  - 内核支持线程：切换需要依赖内核（java线程是内核级线程）
  - 用户级线程：切换与内核无关
- 两种线程的对比
  - 线程的调度和切换速度
  - 系统调用
  - 线程执行时间