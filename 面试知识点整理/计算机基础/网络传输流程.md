# 网络传输流程

- 从浏览器中输入www.baidu.com后，执行的全过程
  - 应用层：DNS，HTTP/HTTPS
  - 传输层：TCP（DNS的传输层协议是UDP）
  - 网络层：IP和路由选择协议：RIP和OSPF（内部网关协议），BGP（外部网关协议）
  - 数据链路层：ARP
- session，cookie和tokenhttps://zhuanlan.zhihu.com/p/63061864
- 对HTTP（超文本传输协议）的理解
  - http是在web中专门用来在两点之前传输文字，图片，音频，视频等超文本数据的约定和规范
  - 五大类常见的状态码
    - 1xx：提示信息，是协议处理中的一种中间状态，实际用到的比较少
    - 2xx：表示服务器成功处理了客户端的请求，也是我们最愿意看到的状态。
      - 「200 OK」是最常见的成功状态码，表示一切正常。如果是非 HEAD 请求，服务器返回的响应头都会有 body 数据。
      - 「204 No Content」也是常见的成功状态码，与 200 OK 基本相同，但响应头没有 body 数据。
      - 「206 Partial Content」是应用于 HTTP 分块下载或断电续传，表示响应返回的 body 数据并不是资源的全部，而是其中的一部分，也是服务器处理成功的状态。
    - 3xx：表示客户端请求的资源发送了变动，需要客户端用新的 URL 重新发送请求获取资源，也就是重定向。
      - 「301 Moved Permanently」表示永久重定向，说明请求的资源已经不存在了，需改用新的 URL 再次访问。
      - 「302 Moved Permanently」表示临时重定向，说明请求的资源还在，但暂时需要用另一个 URL 来访问。
      - 301 和 302 都会在响应头里使用字段 Location，指明后续要跳转的 URL，浏览器会自动重定向新的 URL。
      - 「304 Not Modified」不具有跳转的含义，表示资源未修改，重定向已存在的缓冲文件，也称缓存重定向，用于缓存控制。
    - 4xx：表示客户端发送的报文有误，服务器无法处理，也就是错误码的含义。
      - 「400 Bad Request」表示客户端请求的报文有错误，但只是个笼统的错误。
      - 「403 Forbidden」表示服务器禁止访问资源，并不是客户端的请求出错。
      - 「404 Not Found」表示请求的资源在服务器上不存在或未找到，所以无法提供给客户端。
      - http1.1新增的：409（Conflict）表示请求的资源与资源的当前状态发生冲突；410（Gone）表示服务器上的某个资源被永久性的删除。
    - 5xx:表示客户端请求报文正确，但是服务器处理时内部发生了错误，属于服务器端的错误码。
      - 「500 Internal Server Error」与 400 类型，是个笼统通用的错误码，服务器发生了什么错误，我们并不知道。
      - 「501 Not Implemented」表示客户端请求的功能还不支持，类似“即将开业，敬请期待”的意思。
      - 「502 Bad Gateway」通常是服务器作为网关或代理时返回的错误码，表示服务器自身工作正常，访问后端服务器发生了错误。由于服务器当前 链接 太多，导致服务器方面无法给于正常的响应，产生此类报错
      - 「503 Service Unavailable」表示服务器当前很忙，暂时无法响应服务器，类似“网络服务正忙，请稍后重试”的意思。
      - 504：网关超时，由作为代理或网关的服务器使用，表示不能及时地从远程服务器获得应答
  - GET 和 POST 方法都是安全和幂等的吗？
    - 在 HTTP 协议里，所谓的「安全」是指请求方法不会「破坏」服务器上的资源。
    - 所谓的「幂等」，意思是多次执行相同的操作，结果都是「相同」的
    -  **GET 方法就是安全且幂等的**，因为它是「只读」操作，无论操作多少次，服务器上的数据都是安全的，且每次的结果都是相同的。
    - POST 因为是「新增或提交数据」的操作，会修改服务器上的资源，所以是不安全的，且多次提交数据就会创建多个资源，所以**不是幂等的**。
    - https://www.cnblogs.com/logsharing/p/8448446.html
  - http协议的优点和缺点
    - 优点：简单、灵活、易于扩展、应用广泛和跨平台
    - 缺点：
      - 无状态：用 Cookie 技术。Cookie 通过在请求和响应报文中写入 Cookie 信息来控制客户端的状态
      - 明文传输：调试方便，不安全；
        - HTTP 的安全问题，可以用 HTTPS 的方式解决，也就是通过引入 SSL/TLS 层
  - http/1.1的性能如何？HTTP 协议是基于 TCP/IP，并且使用了「请求 - 应答」的通信模式，所以性能的关键就在这两点里。
    - 长连接的通信方式，也叫持久连接。这种方式的好处在于减少了 TCP 连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载。
      持久连接的特点是，只要任意一端没有明确提出断开连接，则保持 TCP 连接状态。
    - 管道网络传输
      - HTTP/1.1 采用了长连接的方式，这使得管道（pipeline）网络传输成为了可能。
        即可在同一个 TCP 连接里面，客户端可以发起多个请求，只要第一个请求发出去了，不必等其回来，就可以发第二个请求出去，可以减少整体的响应时间。
    - 队头阻塞
      - 当顺序发送的请求序列中的一个请求因为某种原因被阻塞时，在后面排队的所有请求也一同被阻塞了，会招致客户端一直请求不到数据，这也就是「队头阻塞」
    - 总之 HTTP/1.1 的性能一般般，后续的 HTTP/2 和 HTTP/3 就是在优化 HTTP 的性能。
- HTTP 与 HTTPS 有哪些区别？
  - HTTP 是超文本传输协议，信息是明文传输，存在安全风险的问题。HTTPS 则解决 HTTP 不安全的缺陷，在 TCP 和 HTTP 网络层之间加入了 SSL/TLS 安全协议，使得报文能够加密传输。
  - HTTP 连接建立相对简单， TCP 三次握手之后便可进行 HTTP 的报文传输。而 HTTPS 在 TCP 三次握手之后，还需进行 SSL/TLS 的握手过程，才可进入加密报文传输。
  - HTTP 的端口号是 80，HTTPS 的端口号是 443。
  - HTTPS 协议需要向 CA（证书权威机构）申请数字证书，来保证服务器的身份是可信的。
  - 常见的加密算法
    - ![image-20201115174626904](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201115174626904.png)
- https优势
  - 信息加密：混合加密方式实现信息的加密性
    - 在通信建立前采用非对称加密的方式交换「会话秘钥」
    - 在通信过程中全部使用对称加密的「会话秘钥」的方式加密明文数据
  - 摘要算法来实现完整性
  - 将服务器公钥放入到数字证书中，减少了被冒充的风险
    - 借助第三方权威机构 CA （数字证书认证机构），将服务器公钥放在数字证书（由数字证书认证机构颁发）中，保证公钥不被篡改和信任度
- 其他：https://zhuanlan.zhihu.com/p/112010468
  - SSL/TLS的建立过程，即握手阶段
  - HTTP/1.1 HTTP/2  HTTP/3的演变过程
- HTTP断点续传（分块传输）https://www.cnblogs.com/findumars/p/5745345.html
  - 指的是在上传/下载时，将任务（一个文件或压缩包）人为的划分为几个部分，每一个部分采用一个线程进行上传/下载，如果碰到网络故障，可以从已经上传/下载的部分开始继续上传/下载未完成的部分，而没有必要从头开始上传/下载。可以节省时间，提高速度。
- 网络请求的流程
  - 通过url找ip
  - 对ip结果建立tcp连接
  - 向服务器发送数据
  - 服务器解析，并返回
  - 浏览器解析html
- TCP连接的三次握手和四次挥手
- 流量控制和拥塞控制的区别：
  - 拥塞控制是作用于网络的，是防止过多的数据注入到网络，避免网络出现负载过大的情况
  - 流量控制是基于接受者的，是控制发送方的发送速度从而使接受者来得及接收，防止分组丢失
- 流量控制
  - 滑动窗口协议：主要方式是接收方返回的ack中会包含自己的接收窗口的大小，并且利用大小来控制发送方的数据发送
    - 但是可能引起死锁
    - 避免:每当发送者收到一个零窗口的应答之后就启动该计时器，时间一到便主动发送报文询问接受者，如果接受者仍然返回窗口是0，则重置计时器继续等待；否则，表示应答报文丢失，此时重置发送窗口后开始发送，这样就避免了死锁的产生。
- 拥塞控制：（1）慢开始、拥塞避免（2）快重传，快恢复
  - 慢开始，拥塞避免
    - 发送发维持一个拥塞窗口，大小取决于网络状态，在动态变化
    - 刚开始的发送窗口很小，经过一个传输轮次，拥塞窗口就加倍
    - 当发送窗口大于慢开始门限时，发送窗口还是缓慢增长
    - 当网络出现拥塞时，就把慢开始门限设置为出现拥塞时的发送窗口大小的一半
    - 将发送窗口重新设置为1，执行慢开始算法
  - 快重传，快恢复
    - 