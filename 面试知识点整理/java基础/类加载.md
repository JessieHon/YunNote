# 类加载器以及双亲委派模型

- java类和类加载的关系
  - 只有一个Java类全限定名并不能确定唯一的Java类。Java类只有与类加载一起才能确定一个唯一的类对象。
  - 当类加载器加载类时，会在类加载的名称空间中标识该类名称，以保证类加载器和类全名共同确定一个类对象。
- Java中的类加载大体分为四类：
  - 启动类加载器（Bootstrap ClassLoader）
    - 负责加载JDK目录中\lib文件夹中的类，或者被-Xbootclasspath参数指定的路径下的可识别类。整个Java系统中很多基本组件都是有启动类加载器加载的，就连扩展类加载器和应用程序类加载器都是通过它加载的。在一个Java程序运行时，首先启动JVM，之后马上就诞生了启动类加载器，然后启动类加载器加载剩下两个系统加载器，之后这两个加载器再加载他们应该加载的类。
  - 扩展类加载器（Extension  ClassLoader）
    - 负责加载JDK目录中\lib\ext文件夹中的类，或者被java.ext.dirs系统变量所指定的路径中的类库。这个类加载器的作用是用来与启动类加载器合作加载系统组件的。
  - 应用程序类加载器（Application ClassLoader）
    - 负责加载ClassPath路径下的类，可以通过getSystemClassLoader()获取。如果没有自己定义类加载，我们编写的Java类都将被这个类加载器加载。是程序中的默认类加载
  - 用户自定义类加载器（User ClassLoader）
    - 用户自己编写的类加载器，可以通过覆盖findClass()方法去进行加载类。
- 双亲委派模型
  - 除了启动类加载器，每个类加载器都有一个父加载器。构成了一个类加载器结构系统。这个系统就是用来完成双亲委派机制的。
  - 一个类加载器加载一个类时，首先会把加载动作委派给他的父加载器，如果父加载器无法完成这个加载动作时才由该类加载器进行加载。由于类加载器会向上传递加载请求，所以一个类加载时，首先尝试加载它的肯定是启动类加载器（逐级向上传递请求，直到启动类加载器，它没有父加载器），之后根据是否能加载的结果逐级让子类加载器尝试加载，直到加载成功。
- 双亲委派模型的作用
  - 由于双亲委派机制的存在，类加载器的数量增多了不少，增加了程序的复杂性。不过存在既有道理。双亲委派机制让Java类体系变得稳定，有层次性能。特定的类由特定的类加载器加载，每次加载都委托父类的过程让类对象在内存中的数量保持为一个，让同类名的类无法被替换。
- 怎么避免自己写的类加载器破坏了双亲委派机制
  - 抽象classLoader类中，loadClass()方法是一个类加载的主要方法，这个方法中对类加载的主要操作集中在findClass()方法中，其他代码都是在维护双亲委派机制，所以我们在实现自己的类加载器时，只需要重写findClass方法即可，让loadClass方法保持原样以便双亲委派机制的正确运行。